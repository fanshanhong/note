from：https://blog.csdn.net/liitdar/article/details/79896457

## 1. 概念、背景及架构

**CGI**（Common Gateway Interface），即通用网关接口，是WWW技术中最重要的技术之一，是外部应用程序（即CGI程序）与WEB服务器之间的接口标准，负责在CGI程序和Web服务器之间传递信息。CGI是：Web服务器运行时，调用外部应用程序（即CGI程序）的规范，CGI规范允许Web服务器执行外部程序，并将它们的输出发送给Web浏览器，CGI将Web的一组简单的静态超媒体文档变成一个完整的、新的交互式媒体，按照CGI编写的程序可以扩展Web服务器功能。

**出现背景：**CGI是比较原始的开发动态网站的方式。由于静态的html页面无法实现网站的动态内容的生成，所以就需要由web服务器调用CGI程序，CGI程序生成动态内容，返回给web服务器，web服务器再返回给浏览器。

**CGI应用程序**能通过Web服务器与浏览器进行交互，还可以通过数据库API与数据库服务器等外部数据源进行通信，从数据库服务器中获取数据，将数据格式化为HTML文档后，发送给浏览器，也可以将从浏览器获得的数据放到数据库中。如下图：

![img](https://img-blog.csdn.net/20180411151204476?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2xpaXRkYXI=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70)

几乎所有Web服务器都支持CGI，我们可用多种语言编写CGI（包括流行的C、C ++等），只要这种语言具有标准输入、输出和环境变量。

大多数的CGI程序被用来解释处理来自表单的输入信息，并在服务器产生相应的处理，或将相应的信息反馈给浏览器，CGI程序使网页具有了交互功能。

## 2. CGI程序处理步骤

\1. 浏览器通过HTML表单或超链接，请求指向一个CGI应用程序的URL；

\2. 服务器收到浏览器发送的请求；

\3. 服务器调用执行指定CGI应用程序；

\4. CGI应用程序根据相关信息（通常是基于浏览者输入的内容），执行具体的操作；

\5. CGI应用程序把操作结果格式化为网络服务器和浏览器能够理解的文档（通常是HTML网页），并发送给web服务器；

\6. web服务器把操作结果返回给浏览器。

 

由于环境变量的大小是有一定限制的，当需要传送的数据量很大时，环境变量的存储空间可能会不足，造成传输数据接收不完全，甚至无法执行 CGI 程序。因此，后来又发展出另外一种方法：POST，也就是利用 I/O 重新导向的技巧，让 CGI 程序可以由 STDIN 和 STDOUT 直接跟浏览器沟通。当我们指定用这种方法传递请求的数据时， web 服务器收到数据后，会先将这些数据放在一块输入缓冲区中，并且将数据的大小记录在 CONTENT_LENGTH 环境变量中，然后调用 CGI 程序并将 CGI 程序的 STDIN 指向这块缓冲区，于是我们就可以很顺利的通过 STDIN 和环境变量 CONTENT_LENGTH 得到服务器接收的信息，避免了对传输信息大小的限制。

##  

## 3. CGI的优缺点

CGI可以为我们提供许多HTML无法做到的功能，比如记数器、顾客信息表格的提交以及统计、搜索程序、WEB数据库等。

用Html是没有办法记住客户的任何信息的，要把客户端的信息记录在服务器的硬盘上，就要用到CGI，这是CGI最重要的作用，它补充了Html的不足，注意：仅仅是补充，不是替代。

CGI 使外部程序与 Web 服务器之间交互成为可能， CGI 程序运行在独立的进程中，并对每个 Web 请求建立一个进程，这种方法非常容易实现，但效率很差，难以扩展。当面对大量请求时，进程的大量建立和消亡会使操作系统性能大大下降，此外，由于地址空间无法共享，也限制了资源重用。

为了解决 CGI 存在的上述问题，出现了 CGI 的升级版 FastCGI，关于 FastCGI 的相关内容，点击[此处](https://blog.csdn.net/liitdar/article/details/80359467)。